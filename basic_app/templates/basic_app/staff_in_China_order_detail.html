{% extends 'base.html' %}

{% load static %}

{% block javascript %}
    <script src="{% static 'js/app.js' %}"></script>
{% endblock %}

{% block body_block %}
<div class="container">
  <div class="jumbotron">
    <h1 class="display-4">Order Details</h1>
  </div><!-- /.jumbotron -->
  {% if dic == None %}
    <p>You don't have any proof</p>
    {% else %}
      <div class="col-xs-1" align="center"><img class="img-thumbnail img-fluid" src={{pic_src}} alt="No graph or graph crashes"></div>
      <br>
      <table class = "table table-striped">
          <thead>
            <tr>
              <th scope="col">Information</th>
              <th scope="col">Detail</th>
            </tr>
          </thead>
          <tbody>
            {% for key, values in dic.items %}
              <tr>
                <td>{{key}}</td>
                <td>{{values}}</td>
              </tr>
            {% endfor %}
          </tbody>
      </table>
    <form method='post' action="">
        {% csrf_token %}
        <table class = "table table-striped" >
            <tr>
                <th>
                    <input name = "image" id="photoupload" type="file" accept="image/*">
                </th>
                <th>
                    {% csrf_token %}
                    <input type="button" id = "addphoto" onclick= addPhoto('myalbum') value="upload grpah" > </input>
                    <script type="text/javascript">
                    var albumBucketName = 'nicealbum';
                        var bucketRegion = 'us-west-2';
                        var IdentityPoolId = 'us-west-2:68e87141-66af-49e1-b0b0-0d0764a9f515';

                        AWS.config.update({
                          region: bucketRegion,
                          credentials: new AWS.CognitoIdentityCredentials({
                            IdentityPoolId: IdentityPoolId
                          })
                        });

                        var s3 = new AWS.S3({
                          apiVersion: '2006-03-01',
                          params: {Bucket: albumBucketName}
                        });
                        function addPhoto(albumName) {
                          var files = document.getElementById('photoupload').files;
                          if (!files.length) {
                            return alert('Please choose a file to upload first.');
                          }
                          var file = files[0];
                          var fileName = file.name;
                          var photoKey = fileName;

                          s3.upload({
                            Key: photoKey,
                            Body: file,
                            ACL: 'public-read'
                          }, function(err, data) {
                            if (err) {
                              return alert('There was an error uploading your graph: ', err.message);
                            }
                            alert('Successfully uploaded graph.');
                          });
                        }
                    </script>
                </th>
            </tr>
            <tr>
                <th>Confirm Order Number <input type="text" name="secondNumber" required ></th>
                {% csrf_token %}
                <th><input type="submit"  class="btn btn-info float-right" ></th>
            </tr>
        </table>    
    </form>
{% endif %}

{% endblock %}